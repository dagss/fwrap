python module __user__routines 
    interface
        subroutine callback(n, ret)
            integer intent(in) :: n
            integer intent(out) :: ret
        end subroutine callback
        subroutine callback2darr(x, n, m)
            integer, intent(hide) :: n, m
            real*8, intent(in,out), dimension(n, m) :: x
        end subroutine callback2darr
    end interface
end python module __user__routines

python module pyf_callbacks
    interface
       subroutine foo(callback, x)
       use __user__routines
       external callback
       integer, intent(in,out) :: x
       end subroutine

       subroutine array2d(callback2darr, x, n, m)
       use __user__routines
       external callback2darr
       real*8, intent(in,out), dimension(n, m) :: x
       integer, intent(in) :: n, m
       end subroutine

    end interface 
end python module pyf_callbacks
